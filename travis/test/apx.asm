; APX testcases

%macro testcase 2
 %ifdef BIN
  db %1
 %endif
 %ifdef SRC
  %2
 %endif
%endmacro


bits 64

; aadd instruction
testcase	{0x0F, 0x38, 0xFC, 0x0A},		{aadd [rdx],ecx}		;m32 <- r32 regular
testcase	{0x48, 0x0F, 0x38, 0xFC, 0x0A},		{aadd [rdx],rcx}		;m64 <- r64 regular
testcase	{0x62, 0xF4, 0x7C, 0x08, 0xFC, 0x0A},	{aadd {evex} [rdx],ecx}		;m32 <- r32 explicit evex
testcase	{0x62, 0xF4, 0xFC, 0x08, 0xFC, 0x0A},	{aadd {evex} [rdx],rcx}		;m64 <- r64 explicit evex
testcase	{0x62, 0x64, 0xFC, 0x08, 0xFC, 0x0A},	{aadd [rdx],r25}		;m64 <- er64

; aand instruction
testcase	{0x66, 0x0F, 0x38, 0xFC, 0x0A},		{aand [rdx],ecx}		;m32 <- r32 regular
testcase	{0x66, 0x48, 0x0F, 0x38, 0xFC, 0x0A},	{aand [rdx],rcx}		;m64 <- r64 regular
testcase	{0x62, 0xF4, 0x7D, 0x08, 0xFC, 0x0A},	{aand {evex} [rdx],ecx}		;m32 <- r32 explicit evex
testcase	{0x62, 0xF4, 0xFD, 0x08, 0xFC, 0x0A},	{aand {evex} [rdx],rcx}		;m64 <- r64 explicit evex
testcase	{0x62, 0x64, 0xFD, 0x08, 0xFC, 0x0A},	{aand [rdx],r25}		;m64 <- er64

; aor instruction
testcase	{0xF2, 0x0F, 0x38, 0xFC, 0x0A},		{aor [rdx],ecx}			;m32 <- r32 regular
testcase	{0xF2, 0x48, 0x0F, 0x38, 0xFC, 0x0A},	{aor [rdx],rcx}			;m64 <- r64 regular
testcase	{0x62, 0xF4, 0x7F, 0x08, 0xFC, 0x0A},	{aor {evex} [rdx],ecx}		;m32 <- r32 explicit evex
testcase	{0x62, 0xF4, 0xFF, 0x08, 0xFC, 0x0A},	{aor {evex} [rdx],rcx}		;m64 <- r64 explicit evex
testcase	{0x62, 0x64, 0xFF, 0x08, 0xFC, 0x0A},	{aor [rdx],r25}			;m64 <- er64

; axor instruction
testcase	{0xF3, 0x0F, 0x38, 0xFC, 0x0A},		{axor [rdx],ecx}		;m32 <- r32 regular
testcase	{0xF3, 0x48, 0x0F, 0x38, 0xFC, 0x0A},	{axor [rdx],rcx}		;m64 <- r64 regular
testcase	{0x62, 0xF4, 0x7E, 0x08, 0xFC, 0x0A},	{axor {evex} [rdx],ecx}		;m32 <- r32 explicit evex
testcase	{0x62, 0xF4, 0xFE, 0x08, 0xFC, 0x0A},	{axor {evex} [rdx],rcx}		;m64 <- r64 explicit evex
testcase	{0x62, 0x64, 0xFE, 0x08, 0xFC, 0x0A},	{axor [rdx],r25}		;m64 <- er64
